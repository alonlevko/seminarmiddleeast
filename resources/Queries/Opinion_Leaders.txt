select distinct b.id,b.screen_name,b.followers_cnt,b.status_cnt,b.likes_cnt,b.retweet_cnt from (select a.id,a.screen_name,a.followers_cnt,a.status_cnt,a.likes_cnt,a.retweet_cnt,a.count_id,rank() over (partition by a.count_id order by a.followers_cnt desc) as follow_rnk,rank() over (partition by a.count_id order by a.status_cnt desc) as status_rnk,rank() over (partition by a.retweet_cnt order by a.status_cnt desc) as retweet_rnk,rank() over (partition by a.count_id order by a.likes_cnt desc) as likes_rnk from (select f.id,f.screen_name,f.followers_cnt,f.status_cnt,f.likes_cnt,f.retweet_cnt ,count(id) over () as count_id from (select u.id,u.screen_name,cast(u.followers_count as int) as followers_cnt, cast(u.statuses_count as int) as status_cnt, cast(s.total_favorite_count as int) as likes_cnt, cast(s.total_retweet_count as int) as retweet_cnt from users u left join servies_new_twitter_users_db s on u.id = s._id) as f) as a) as b where b.follow_rnk between b.count_id*cast(follow_bottom_param as float) and b.count_id*cast(follow_top_param as float) and b.status_rnk between b.count_id*cast(status_bottom_param as float) and b.count_id*cast(status_top_param as float) and b.likes_rnk between b.count_id*cast(likes_bottom_param as float) and b.count_id*cast(likes_top_param as float) and b.status_rnk between b.count_id*cast(retweet_bottom_param as float) and b.count_id*cast(retweet_top_param as float)
_id,value

all_columns

follow_bottom_param,follow_top_param,status_bottom_param,status_top_param,retweet_bottom_param,retweet_top_param,likes_bottom_param,likes_top_param
This query returns the most popular word in every day